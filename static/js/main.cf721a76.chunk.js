(this["webpackJsonpbook-a-booth"]=this["webpackJsonpbook-a-booth"]||[]).push([[0],{167:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(58),i=n.n(c),o=n(77),s=n(28),u=n(255),l=n(256),d=n(80),j=n(217),b=n(52),f=Object(j.a)({palette:{primary:{main:"#556cd6"},secondary:{main:"#19857b"},error:{main:b.a.A400},background:{default:"#fff"}}}),h=n(237),x=n(34),O=n(23),p=n.n(O),m=n(30),v=n(87),g=n(88),k=n(137),C=n(136),y=function(e){Object(k.a)(n,e);var t=Object(C.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).history=e,r}return Object(g.a)(n,[{key:"navigateInternal",value:function(){var e=Object(m.a)(p.a.mark((function e(t,n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.replace(window.location.origin,""),n.noHistory?this.history.replace(r):this.history.push(r),e.abrupt("return",!1);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(n(124).a),w=n(245),T=n(246),A=n(99),S=n(247),E=n(18),I=n(1),D=function(){var e=Object(x.d)().instance,t=Object(r.useState)(null),n=Object(E.a)(t,2),a=n[0],c=n[1],i=e.getActiveAccount();return Object(r.useEffect)((function(){c(i?i.name.split(" ")[0]:null)}),[i]),a?Object(I.jsxs)(A.a,{variant:"h6",children:["Welcome, ",a]}):null},M=n(238),R=n(234),z=n(231),F=n(86),B=window.navigator.userAgent,N=B.indexOf("MSIE "),L=B.indexOf("Trident/"),H=B.indexOf("Edge/"),Y=B.indexOf("Firefox"),Z={auth:{clientId:"36bc0775-9527-484c-9c48-2e846090732b",authority:"https://login.microsoftonline.com/9c85420c-07ed-40e7-9c4c-4207556dc906",redirectUri:"",postLogoutRedirectUri:""},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:N>0||L>0||H>0||Y>0},system:{loggerOptions:{loggerCallback:function(e,t,n){if(!n)switch(e){case F.a.Error:return void console.error(t);case F.a.Info:return void console.info(t);case F.a.Verbose:return void console.debug(t);case F.a.Warning:return void console.warn(t);default:return}}}}},U={scopes:["User.Read","Calendars.ReadWrite"]},V="https://graph.microsoft.com/v1.0",P=function(){var e=Object(x.d)().instance,t=Object(r.useState)(null),n=Object(E.a)(t,2),a=n[0],c=n[1],i=Boolean(a);return Object(I.jsxs)("div",{children:[Object(I.jsx)(M.a,{onClick:function(e){return c(e.currentTarget)},color:"inherit",children:"Login"}),Object(I.jsx)(z.a,{id:"menu-appbar",anchorEl:a,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:i,onClose:function(){return c(null)},children:Object(I.jsx)(R.a,{onClick:function(){return t="redirect",c(null),void("popup"===t?e.loginPopup(U):"redirect"===t&&e.loginRedirect(U));var t},children:"Sign in"},"loginRedirect")})]})},W=n(244),G=n(128),J=n.n(G),q=n(37),K=n(236),$=n(240),_=n(233),Q=n(243),X=n(225),ee=n(242),te=n(241),ne=n(126),re=n.n(ne),ae=n(127),ce=n.n(ae),ie=function(e){var t=Object(x.d)(),n=t.instance,r=t.accounts,a=e.onClose,c=e.open,i=function(e){n.setActiveAccount(e),e?window.location.reload():n.loginRedirect(Object(q.a)(Object(q.a)({},U),{},{prompt:"login"})),a(e)};return Object(I.jsxs)(te.a,{onClose:a,"aria-labelledby":"simple-dialog-title",open:c,children:[Object(I.jsx)(ee.a,{id:"simple-dialog-title",children:"Set active account"}),Object(I.jsxs)($.a,{children:[r.map((function(e){return Object(I.jsxs)(_.a,{button:!0,onClick:function(){return i(e)},children:[Object(I.jsx)(Q.a,{children:Object(I.jsx)(K.a,{children:Object(I.jsx)(re.a,{})})}),Object(I.jsx)(X.a,{primary:e.name,secondary:e.username})]},e.homeAccountId)})),Object(I.jsxs)(_.a,{autoFocus:!0,button:!0,onClick:function(){return i(null)},children:[Object(I.jsx)(Q.a,{children:Object(I.jsx)(K.a,{children:Object(I.jsx)(ce.a,{})})}),Object(I.jsx)(X.a,{primary:"Add account"})]})]})]})},oe=function(){var e=Object(x.d)().instance,t=Object(r.useState)(!1),n=Object(E.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(null),o=Object(E.a)(i,2),s=o[0],u=o[1],l=Boolean(s);return Object(I.jsxs)("div",{children:[Object(I.jsx)(W.a,{onClick:function(e){return u(e.currentTarget)},color:"inherit",children:Object(I.jsx)(J.a,{})}),Object(I.jsxs)(z.a,{id:"menu-appbar",anchorEl:s,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:l,onClose:function(){return u(null)},children:[Object(I.jsx)(R.a,{onClick:function(){return u(null),void c(!0)},children:"Switch Account"},"switchAccount"),Object(I.jsx)(R.a,{onClick:function(){return t="redirect",u(null),void("popup"===t?e.logoutPopup():"redirect"===t&&e.logoutRedirect());var t},children:"Logout"},"logoutRedirect")]}),Object(I.jsx)(ie,{open:a,onClose:function(){c(!1)}})]})},se=n(5),ue=function(){var e=Object(x.d)().inProgress;return Object(x.c)()?Object(I.jsx)(oe,{}):e!==se.g.Startup&&e!==se.g.HandleRedirect?Object(I.jsx)(P,{}):null},le=n(229),de=n(120),je=Object(le.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1,"& a":{textDecoration:"none"}},bookingCell:{backgroundColor:de.a.A400,"& div":{display:"flex",flexDirection:"column",width:"100%"}}}})),be=n(140),fe=function(e){var t=e.width,n=e.height,r=e.color,a=e.textColor,c=e.showText,i={width:"100px",height:"100px"};return t&&(i.width=t),n&&(i.height=n),r||(r="#000"),a||(a="#fff"),void 0===c&&(c=!0),Object(I.jsx)(be.a,{viewBox:"0 0 50 20",style:i,children:Object(I.jsxs)("g",{id:"logo-socialfinance",children:[Object(I.jsx)("circle",{id:"circle",cx:"10",cy:"10",r:"10",color:r}),Object(I.jsx)("rect",{x:"22",y:"1",width:"18",height:"18",color:r}),c&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("text",{x:"10",y:"18",style:{font:"heavy 20px Klavika Bold, sans-serif",color:a},children:"s"}),Object(I.jsx)("text",{x:"33",y:"21",style:{font:"heavy 20px Klavika Bold, sans-serif",color:a},children:"f"})]})]})})},he=function(){var e=je();return Object(I.jsx)("div",{className:e.root,children:Object(I.jsx)(w.a,{position:"static",children:Object(I.jsxs)(T.a,{children:[Object(I.jsx)(A.a,{className:e.title,children:Object(I.jsxs)(S.a,{component:o.b,to:"/",color:"inherit",variant:"h6",sx:{display:"flex",alignItems:"center"},children:[Object(I.jsx)(fe,{width:75,showText:!1,color:"#FFF"})," Booth Booking"]})}),Object(I.jsx)(D,{}),Object(I.jsx)(ue,{})]})})})},xe=n(248),Oe=function(){return Object(I.jsxs)(A.a,{variant:"body2",color:"textSecondary",align:"center",children:["Made with \u2764\ufe0f by ",Object(I.jsx)(S.a,{color:"inherit",href:"https://github.com/kws",sx:{textDecoration:"none"},children:"Kaj"})]})},pe=n(13),me=Object(le.a)((function(e){return{root:Object(pe.a)({position:"fixed",display:"flex",bottom:50,right:-130,width:"400px",padding:"2px 1px 1px 1px",background:"#FFF",overflow:"hidden",transform:"rotate(-45deg)","-webkit-transform":" rotate(-45deg)","-ms-transform":"rotate(-45deg)","-moz-transform":"rotate(-45deg)","-o-transform":"rotate(-45deg)",boxShadow:"4px 4px 10px rgba(0, 0, 0, 0.8)",zIndex:9999,"& a":{width:"100%",background:"#000",color:"#fff",textDecoration:"none",fontFamily:"arial, sans-serif",textAlign:"center",fontWeight:"bold",padding:"5px 40px",fontSize:"1rem",lineHeight:"2rem",position:"relative",transition:"0.5s","&:hover":{background:"cornflowerblue",color:"#fff"}},"& a::before, a::after":{content:"",width:"100%",display:"block",position:"absolute",top:"1px",left:0,height:"1px",background:"#fff"},"& a::after":{bottom:"1px",top:"auto"}},e.breakpoints.down("sm"),{"& a":{fontSize:"0.5rem",lineHeight:"1rem"},bottom:20,right:-170})}})),ve=function(e){var t=e.repoUrl,n=me();return Object(I.jsx)("span",{className:n.root,children:Object(I.jsx)("a",{href:t,children:"Fork me on GitHub"})})},ge=function(e){return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(he,{}),Object(I.jsx)("br",{}),Object(I.jsx)("br",{}),e.children,Object(I.jsx)(xe.a,{pt:4,children:Object(I.jsx)(Oe,{})}),Object(I.jsx)(ve,{repoUrl:"https://github.com/SocialFinanceDigitalLabs/book-a-booth"})]})},ke=n(25);function Ce(){var e=Object(x.d)().instance;return Object(r.useEffect)((function(){e.logoutRedirect({account:e.getActiveAccount(),onRedirectNavigate:function(){return!ke.a.isInIframe()}})}),[e]),Object(I.jsx)("div",{children:"Logout"})}var ye=n(226),we=n(239),Te=n(249),Ae=n(250),Se=n(251),Ee=n(254),Ie=n(252),De=n(253),Me=n(131),Re=n.n(Me),ze=n(132),Fe=n.n(ze),Be=n(133),Ne=n.n(Be),Le=n(33),He=n.n(Le),Ye=["#EF9A9A","#FFCC80","#FFF59D"],Ze=function(e){var t=e.calendarService,n=e.bookClick,a=e.deleteEventClick,c=t.dates,i=t.boothData,o=t.calendarData,s=Object(r.useMemo)((function(){return c&&c.datesIndexes?c.datesIndexes[0].map((function(e){return{time:c.intervals[e],days:c.datesIndexes.map((function(t){var n=t[e];return{timeslot:n,start:c.intervals[n],end:c.intervals[n]+c.interval,available:i?i.available[n]:-1,event:o?o.filter((function(e){return e.id===o.intervals[n]})):[]}}))}})):[]}),[c,i,o]);return Object(I.jsx)(Te.a,{component:we.a,children:Object(I.jsxs)(Ae.a,{sx:{minWidth:250},size:"small",children:[Object(I.jsx)(Se.a,{children:Object(I.jsxs)(Ie.a,{children:[Object(I.jsx)(De.a,{children:"Time"}),c.dates.map((function(e){return Object(I.jsx)(De.a,{align:"center",children:He.a.unix(e.noon).format("ddd, D MMM")},e.noon)}))]})}),Object(I.jsx)(Ee.a,{children:s.map((function(e,t){var r=t%2===0?0:"1px solid #eee";return Object(I.jsxs)(Ie.a,{sx:{"td,th":{borderBottom:r,borderRight:"1px solid #eee"},"&:last-child td, &:last-child th":{borderBottom:0}},children:[Object(I.jsx)(De.a,{component:"th",scope:"row",children:He.a.unix(e.time).format("HH:mm")}),e.days.map((function(e){return Object(I.jsx)(Ue,{day:e,bookClick:n,deleteEventClick:a},e.timeslot)}))]},e.time)}))})]})})},Ue=function(e){var t=e.day,n=e.bookClick,a=e.deleteEventClick,c=Object(r.useState)("normal"),i=Object(E.a)(c,2),o=i[0],s=i[1],u=Object(r.useCallback)(function(){var e=Object(m.a)(p.a.mark((function e(t,r){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(t,r);case 2:return a=e.sent,s("normal"),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[n]),l=Object(r.useCallback)((function(){"normal"===o&&s("selected")}),[o]);return t.end<Date.now()/1e3?Object(I.jsx)(De.a,{}):t.event&&t.event.length>0?Object(I.jsx)(Ve,{day:t,deleteEventClick:a}):"normal"===o?Object(I.jsx)(Pe,{day:t,onClick:l}):Object(I.jsx)(We,{day:t,onCancel:function(){return s("normal")},bookClick:u,align:"center"})},Ve=function(e){var t=e.day,n=e.deleteEventClick,a=je(),c=Object(r.useState)(!1),i=Object(E.a)(c,2),o=i[0],s=i[1],u=Object(r.useState)(!1),l=Object(E.a)(u,2),d=l[0],j=l[1];return o?Object(I.jsx)(De.a,{align:"center",className:a.bookingCell,children:Object(I.jsxs)("div",{children:[Object(I.jsxs)(M.a,{variant:"contained",color:"error",onClick:function(){j(!0),s(!1),n(t.event[0].id)},children:["Cancel ",t.event[0].subject]}),Object(I.jsx)(M.a,{variant:"outlined",onClick:function(){return s(!1)},children:"Leave as is"})]})}):Object(I.jsxs)(De.a,{align:"center",onClick:function(){return s(!0)},children:[d&&"Cancelling ",t.event[0].subject]})},Pe=function(e){var t,n=e.day,r=e.onClick,a=n.available>=Ye.length?"#A5D6A7":Ye[n.available];return t=0===n.available?Re.a:n.available<=2?Fe.a:Ne.a,Object(I.jsx)(De.a,{sx:{backgroundColor:a},align:"center",onClick:r,children:Object(I.jsx)(t,{})})},We=function(e){var t=e.day,n=e.onCancel,a=e.bookClick,c=je(),i=Object(r.useState)(!1),o=Object(E.a)(i,2),s=o[0],u=o[1],l=Object(r.useCallback)((function(e){u(!0),a(t.start,e).then((function(e){return u(!1)}))}),[t,a]);return s?Object(I.jsx)(De.a,{align:"center",className:c.bookingCell,children:"Sending Booking Request..."}):Object(I.jsx)(De.a,{align:"center",className:c.bookingCell,children:Object(I.jsxs)("div",{children:[Object(I.jsx)(A.a,{children:"Book Booth"}),Object(I.jsx)(M.a,{variant:"outlined",onClick:function(){return l(30)},children:"30 min"}),Object(I.jsx)(M.a,{variant:"outlined",onClick:function(){return l(60)},children:"60 min"}),Object(I.jsx)(M.a,{variant:"outlined",onClick:function(){return l(90)},children:"90 min"}),Object(I.jsx)(M.a,{variant:"outlined",onClick:function(){return l(120)},children:"120 min"}),Object(I.jsx)(M.a,{variant:"contained",onClick:n,children:"Cancel"})]})})},Ge=function(){return Object(I.jsx)(A.a,{variant:"h6",children:"Authentication in progress..."})},Je=function(e){var t=e.error;return Object(I.jsxs)(A.a,{variant:"h6",children:["An Error Occurred: ",t.errorCode]})},qe=n(26),Ke=n(228),$e=n(17),_e=function(){var e=new Ke.a(Z);return!e.getActiveAccount()&&e.getAllAccounts().length>0&&e.setActiveAccount(e.getAllAccounts()[0]),e.enableAccountStorageEvents(),e.addEventCallback((function(t){if(t.eventType===$e.a.LOGIN_SUCCESS&&t.payload.account){var n=t.payload.account;e.setActiveAccount(n)}})),e}(),Qe=n(53),Xe=function(){var e=Object(m.a)(p.a.mark((function e(t,n){var r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,et(t,n);case 2:return r=e.sent,e.next=5,r.json();case 5:r=e.sent,a=r.value;case 7:if(!r["@odata.nextLink"]){e.next=17;break}return e.next=10,et(r["@odata.nextLink"]);case 10:return r=e.sent,e.next=13,r.json();case 13:r=e.sent,a.push.apply(a,Object(qe.a)(r.value)),e.next=7;break;case 17:return e.abrupt("return",a);case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),et=function(){var e=Object(m.a)(p.a.mark((function e(t,n){var r,a,c,i,o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=_e.getActiveAccount()){e.next=3;break}throw Error("No active account! Verify a user has been signed in and setActiveAccount has been called.");case 3:return e.next=5,_e.acquireTokenSilent(Object(q.a)(Object(q.a)({},U),{},{account:r}));case 5:return a=e.sent,c=new Headers(null===n||void 0===n?void 0:n.headers),i="Bearer ".concat(a.accessToken),c.append("Authorization",i),o=Object(q.a)(Object(q.a)({method:"GET"},n),{},{headers:c}),s=t.startsWith("http")?t:"".concat(V).concat(t),e.abrupt("return",fetch(s,o).catch(tt(_e)));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),tt=function(e){return function(t){if(!(t instanceof Qe.a))throw t;e.acquireTokenRedirect(Object(q.a)(Object(q.a)({},U),{},{account:e.getActiveAccount()}))}},nt=n(134),rt=n.n(nt),at=n(135),ct=n.n(at),it="YYYY-MM-DDTHH:mmZ",ot="YYYY-MM-DDTHH:mm",st="Europe/London",ut=[1,2,3,4,5,6].map((function(e){return"zoombooth".concat(e,"@socialfinance.org.uk")})),lt=1800;He.a.extend(rt.a),He.a.extend(ct.a);var dt=function(e){var t=e.day();return 0===t?e.add(1,"day"):6===t?e.add(2,"day"):e},jt=function(e){var t=Object(q.a)({},e),n=t.value[0].availabilityView.split("");return t.occupied=n.map((function(e,n){return t.value.reduce((function(e,t){return e+parseInt(t.availabilityView[n])}),0)})),t.available=n.map((function(e,n){return t.value.length-t.occupied[n]})),t},bt=function(e){return e.map((function(e){return(e=Object(q.a)({},e)).booths=e.attendees.filter((function(e){return ut.indexOf(e.emailAddress.address.toLowerCase())>=0})),e.acceptedBooths=e.booths.filter((function(e){return e.status.response.toLowerCase().indexOf("accepted")>=0})),e}))},ft=function(e,t){var n=e.map((function(e){return(e=Object(q.a)({},e)).startTime=He.a.tz(e.start.dateTime,e.start.timeZone).unix(),e.endTime=He.a.tz(e.end.dateTime,e.end.timeZone).unix(),e.startIndex=Math.floor((e.startTime-t.startTime)/t.interval),e.endIndex=Math.ceil((e.endTime-t.startTime)/t.interval)-1,e}));return n.intervals=n.reduce((function(e,t){for(var n=t.startIndex;n<=t.endIndex;n++)e[n]=t.id;return e}),[]),n},ht=function(e){var t=e.startDate,n=e.days,a=Object(r.useState)({dates:[]}),c=Object(E.a)(a,2),i=c[0],o=c[1],s=xt(Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.dates.length>0&&Ot(i));case 1:case"end":return e.stop()}}),e)}))),[i]),u=Object(E.a)(s,2),l=u[0],d=u[1],j=xt(Object(m.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.dates.length>0&&pt(i));case 1:case"end":return e.stop()}}),e)}))),[i]),b=Object(E.a)(j,2),f=b[0],h=b[1];return Object(r.useEffect)((function(){o(function(e,t){for(var n=[],r=He()(e).tz(st).hour(12).minute(0).second(0),a=t>0?t:1,c=0;c<a;c++){var i=(r=dt(r)).format("YYYY-MM-DD");n.push({date:i,noon:He.a.tz("".concat(i,"T12:00:00"),st).unix(),startTime:He.a.tz("".concat(i,"T").concat(8,":00:00"),st).unix(),endTime:He.a.tz("".concat(i,"T").concat(19,":00:00"),st).unix()}),r=r.add(1,"days")}var o={dates:n,startTime:n[0].startTime,endTime:n[n.length-1].endTime,interval:lt};return o.intervalCount=(o.endTime-o.startTime)/lt,o.intervals=Array(Math.ceil(o.intervalCount)).fill(0).map((function(e,t){return o.startTime+t*lt})),o.datesIndexes=n.map((function(e){return o.intervals.map((function(t,n){return t>=e.startTime&&t<e.endTime?n:-1})).filter((function(e){return e>=0}))})),o}(t,n))}),[t,n]),Object(r.useEffect)((function(){d()}),[d]),Object(r.useEffect)((function(){h()}),[h]),Object(r.useMemo)((function(){return{dates:i,boothData:l,calendarData:f,refresh:function(){d(),h()}}}),[i,l,f,d,h])},xt=function(e,t){var n=Object(r.useState)(null),a=Object(E.a)(n,2),c=a[0],i=a[1];return[c,Object(r.useCallback)((function(){e&&e().then((function(e){return i(e)}))}),Object(qe.a)(t))]},Ot=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/me/calendar/getSchedule",n={"Content-Type":"application/json"},r={schedules:ut,startTime:{dateTime:He.a.unix(t.startTime).tz(st).format(ot),timeZone:st},endTime:{dateTime:He.a.unix(t.endTime).tz(st).format(ot),timeZone:st},availabilityViewInterval:Math.round(30)},e.next=5,et("/me/calendar/getSchedule",{method:"POST",headers:n,body:JSON.stringify(r)});case 5:return a=e.sent,e.t0=jt,e.next=9,a.json();case 9:return e.t1=e.sent,e.t2=t,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pt=function(){var e=Object(m.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/me/calendar/calendarView?"+"startDateTime=".concat(encodeURIComponent(He.a.unix(t.startTime).format(it)),"&")+"endDateTime=".concat(encodeURIComponent(He.a.unix(t.endTime).format(it)),"&")+"$select=start,end,subject,attendees&$top=50",e.t0=bt,e.next=4,Xe(n);case 4:return e.t1=e.sent,r=(0,e.t0)(e.t1).filter((function(e){return e.acceptedBooths.length>0})),e.abrupt("return",ft(r,t));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),mt=function(){var e=Object(m.a)(p.a.mark((function e(t,n){var r,a,c,i,o,s,u,l,d,j,b,f,h,x;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=He.a.unix(t).tz(st),a=r.add(n,"minutes"),c={"Content-Type":"application/json"},i={schedules:ut,startTime:{dateTime:r.format(ot),timeZone:st},endTime:{dateTime:a.format(ot),timeZone:st},availabilityViewInterval:n},e.next=6,et("/me/calendar/getSchedule",{method:"POST",headers:c,body:JSON.stringify(i)});case 6:return o=e.sent,e.next=9,o.json();case 9:if(s=e.sent,0!==(u=s.value.filter((function(e){return"0"===e.availabilityView}))).length){e.next=13;break}return e.abrupt("return",{error:"nobooth"});case 13:return l=u[Math.floor(Math.random()*u.length)],d=l.scheduleId,j=d.split("@")[0],b=j.replace("zoombooth",""),f={subject:"Booth ".concat(b),start:{dateTime:r.format(it),timeZone:st},end:{dateTime:r.add(n,"minutes").format(it),timeZone:st},attendees:[{emailAddress:{address:l.scheduleId}}]},e.next=20,et("/me/calendar/events",{method:"POST",headers:c,body:JSON.stringify(f)});case 20:return h=e.sent,e.next=23,h.json();case 23:return x=e.sent,e.abrupt("return",{boothId:d,boothName:j,boothNumber:b,bookingData:x});case 25:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),vt=function(){var e=Object(m.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/me/calendar/events/".concat(t),e.next=3,et(n,{method:"DELETE"});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),gt=function(e){var t=e.bookClick,n=Object(r.useState)(!1),a=Object(E.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)(!0),s=Object(E.a)(o,2),u=s[0],l=s[1],d=Object(r.useCallback)(function(){var e=Object(m.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(!1),e.next=3,t(Math.floor(Date.now()/1e3),n);case 3:i(!1),l(!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]);return Object(I.jsxs)(I.Fragment,{children:[c&&Object(I.jsxs)("div",{children:[Object(I.jsx)(M.a,{disabled:!u,variant:"outlined",color:"secondary",onClick:function(){return i(!1)},children:"Dismiss"}),Object(I.jsx)(M.a,{disabled:!u,variant:"outlined",onClick:function(){return d(30)},children:"30 min"}),Object(I.jsx)(M.a,{disabled:!u,variant:"outlined",onClick:function(){return d(60)},children:"60 min"}),Object(I.jsx)(M.a,{disabled:!u,variant:"outlined",onClick:function(){return d(90)},children:"90 min"}),Object(I.jsx)(M.a,{disabled:!u,variant:"outlined",onClick:function(){return d(120)},children:"120 min"})]}),!c&&Object(I.jsx)(M.a,{variant:"contained",color:"secondary",onClick:function(){return i(!0)},children:"Instant Book"})]})},kt=function(){var e=Object(d.c)("date",d.b),t=Object(E.a)(e,1)[0],n=Object(ye.a)("(max-width:750px)"),a=ht({startDate:t,days:n?2:5});Object(r.useEffect)((function(){var e=setTimeout((function(){return a.refresh()}),15e3);return function(){clearTimeout(e)}}),[a]);var c=Object(r.useCallback)(function(){var e=Object(m.a)(p.a.mark((function e(t,n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt(t,n);case 2:return r=e.sent,setTimeout((function(){return a.refresh()}),3e3),setTimeout((function(){return a.refresh()}),6e3),setTimeout((function(){return a.refresh()}),9e3),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[a]),i=Object(r.useCallback)(function(){var e=Object(m.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vt(t);case 2:setTimeout((function(){return a.refresh()}),2e3),setTimeout((function(){return a.refresh()}),4e3),setTimeout((function(){return a.refresh()}),6e3);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[a]);return Object(I.jsx)(we.a,{children:a&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(gt,{bookClick:c}),Object(I.jsx)(Ze,{calendarService:a,bookClick:c,deleteEventClick:i}),Object(I.jsx)(M.a,{onClick:a.refresh,children:"Refresh"})]})})};function Ct(){var e=Object(q.a)({},U);return Object(I.jsx)(x.a,{interactionType:se.h.Redirect,authenticationRequest:e,errorComponent:Je,loadingComponent:Ge,children:Object(I.jsx)(kt,{})})}function yt(){return Object(I.jsxs)(s.c,{children:[Object(I.jsx)(s.a,{path:"/logout",children:Object(I.jsx)(Ce,{})}),Object(I.jsx)(s.a,{path:"/",children:Object(I.jsx)(Ct,{})})]})}var wt=function(e){var t=e.pca,n=Object(s.f)(),r=new y(n);return t.setNavigationClient(r),Object(I.jsx)(x.b,{instance:t,children:Object(I.jsx)(ge,{children:Object(I.jsx)(h.a,{container:!0,justifyContent:"center",children:Object(I.jsx)(yt,{})})})})};i.a.render(Object(I.jsxs)(a.a.StrictMode,{children:[Object(I.jsx)(u.a,{}),Object(I.jsx)(o.a,{children:Object(I.jsx)(l.a,{theme:f,children:Object(I.jsx)(d.a,{ReactRouterRoute:s.a,children:Object(I.jsx)(wt,{pca:_e})})})})]}),document.getElementById("root"))}},[[167,1,2]]]);
//# sourceMappingURL=main.cf721a76.chunk.js.map